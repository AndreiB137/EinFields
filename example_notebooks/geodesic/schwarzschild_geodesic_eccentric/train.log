2025-07-13 03:02:14,089 - INFO - Storing the config at /system/user/publicwork/crangano/neurips_runs/checkpoints/EinFields/schwarzschild/geodesic_small/pbaeq7v2.
2025-07-13 03:02:14,098 - INFO - Config stored successfully.
2025-07-13 03:02:14,098 - INFO - Final config:
2025-07-13 03:02:14,098 - INFO - architecture:
  activation: silu
  extra_model_args: {}
  hidden_dim: 256
  model_name: MLP
  num_layers: 6
  output_dim: 16
checkpoint:
  load_dir: ''
  reset_optimizer: false
data:
  data_dir: /system/user/publicwork/crangano/neurips_runs/neurips_data/EinFields/geodesic_schwarzschild_small/spherical/no_scale
  losses:
    hessian: false
    jacobian: true
log_dir: /system/user/publicwork/crangano/neurips_runs/checkpoints/EinFields/schwarzschild/geodesic_small
optimizer:
  extra_optimizer_args:
    b1: 0.95
    b2: 0.95
    eps: 1.0e-08
    precondition_frequency: 1
    weight_decay: 0.0
  extra_scheduler_args:
    alpha: 0.001
    decay_steps: 10000
    exponent: 1.0
  learning_rate: 0.001
  lr_scheduler: cosine_decay
  name: soap
run_dir: /system/user/publicwork/crangano/neurips_runs/checkpoints/EinFields/schwarzschild/geodesic_small/pbaeq7v2
training:
  epochs: 100
  gradient_conflict: grad_norm
  integration: false
  metric_type: distortion
  norm: mse
  num_batches: 100
  rng_seed: 0
wandb:
  group: Schwarzschild_geodesic
  name: Schwarzschild_geodesics_eccentric
  project: GRNeF_Brandstetter_lab
  validate_every_n_epochs: 20
  validation_num_batches: 10

2025-07-13 03:02:14,107 - INFO - Data config:
2025-07-13 03:02:14,107 - INFO - compute_volume_element: true
coordinate_system: spherical
data_dir: /system/user/publicwork/crangano/neurips_runs/neurips_data/schwarzschild/EinFields
endpoint:
- true
- true
- true
- false
grid_range:
- - 0.0
  - 0.0
- - 2.5
  - 30.0
- - 0.01
  - 3.1315926535897933
- - 0.0
  - 6.283185307179586
grid_shape:
- 1
- 128
- 128
- 128
metric: Schwarzschild
metric_args:
  G: 1.0
  M: 1.0
  Q: 0.0
  a: 0.0
  c: 1.0
other_coordinate_systems: []
problem: geodesic_schwarzschild_small
recompute_volume_elements: true
store_quantities:
  store_GR_tensors: false
  store_distortion: true
  store_symmetric: true

2025-07-13 03:02:14,112 - INFO - Freezing the config before training...
2025-07-13 03:02:14,115 - INFO - Config freezed successfully.
2025-07-13 03:02:14,115 - INFO - Visible devices: [CudaDevice(id=0)]
2025-07-13 03:02:14,115 - INFO - JAX default backend: gpu
2025-07-13 03:02:14,115 - INFO - Initializing training...
2025-07-13 03:02:14,257 - INFO - Loading data from /system/user/publicwork/crangano/neurips_runs/neurips_data/EinFields/geodesic_schwarzschild_small/spherical/no_scale
2025-07-13 03:02:14,257 - INFO - Loading metric:
2025-07-13 03:02:16,210 - INFO - Metric: (2097152, 16)
2025-07-13 03:02:17,617 - INFO - Loading Jacobian data for training.
2025-07-13 03:02:23,027 - INFO - Jacobian: (2097152, 64)
2025-07-13 03:02:23,027 - INFO - Loading Jacobian and Hessian for validation.
2025-07-13 03:02:45,920 - INFO - Loading complete.
2025-07-13 03:02:47,302 - INFO - Initializing a new run
2025-07-13 03:02:52,328 - INFO - Model: MLP with 6 x 256 hidden layers and 16 outputs
2025-07-13 03:02:52,328 - INFO - Number of parameters: 400144
2025-07-13 03:02:52,328 - INFO - Starting training with 100 batch(es)
2025-07-13 03:11:45,765 - INFO - Loss final: 7.344613198873029e-13, ... {'metric': Array(2.8626572e-13, dtype=float32), 'jacobian': Array(4.4819582e-13, dtype=float32)}
2025-07-13 03:11:45,771 - INFO - Storing checkpoint at /system/user/publicwork/crangano/neurips_runs/checkpoints/EinFields/schwarzschild/geodesic_small/pbaeq7v2/checkpoint
2025-07-13 03:11:46,864 - INFO - Training finished in 572.7489423751831 s
