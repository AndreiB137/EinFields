2025-07-13 12:14:11,016 - INFO - Storing the config at /system/user/publicwork/crangano/neurips_runs/checkpoints/EinFields/schwarzschild/geodesic_perihilion/0iblhdd5.
2025-07-13 12:14:11,025 - INFO - Config stored successfully.
2025-07-13 12:14:11,025 - INFO - Final config:
2025-07-13 12:14:11,025 - INFO - architecture:
  activation: silu
  extra_model_args: {}
  hidden_dim: 128
  model_name: MLP
  num_layers: 6
  output_dim: 16
checkpoint:
  load_dir: ''
  reset_optimizer: false
data:
  data_dir: /system/user/publicwork/crangano/neurips_runs/neurips_data/EinFields/geodesic_perihilion/spherical/no_scale
  losses:
    hessian: false
    jacobian: true
log_dir: /system/user/publicwork/crangano/neurips_runs/checkpoints/EinFields/schwarzschild/geodesic_perihilion
optimizer:
  extra_optimizer_args:
    b1: 0.95
    b2: 0.95
    eps: 1.0e-08
    precondition_frequency: 1
    weight_decay: 0.0
  extra_scheduler_args:
    alpha: 0.001
    decay_steps: 10000
    exponent: 1.0
  learning_rate: 0.001
  lr_scheduler: cosine_decay
  name: soap
run_dir: /system/user/publicwork/crangano/neurips_runs/checkpoints/EinFields/schwarzschild/geodesic_perihilion/0iblhdd5
training:
  epochs: 100
  gradient_conflict: grad_norm
  integration: false
  metric_type: distortion
  norm: mse
  num_batches: 100
  rng_seed: 0
wandb:
  group: Schwarzschild_geodesic_perihilion
  name: Schwarzschild_geodesics_perihilion
  project: GRNeF_Brandstetter_lab
  validate_every_n_epochs: 20
  validation_num_batches: 10

2025-07-13 12:14:11,034 - INFO - Data config:
2025-07-13 12:14:11,034 - INFO - compute_volume_element: true
coordinate_system: spherical
data_dir: /system/user/publicwork/crangano/neurips_runs/neurips_data/EinFields
endpoint:
- true
- true
- true
- false
grid_range:
- - 0.0
  - 0.0
- - 5.0
  - 140.0
- - 0.01
  - 3.1315926535897933
- - 0.0
  - 6.283185307179586
grid_shape:
- 1
- 128
- 128
- 128
metric: Schwarzschild
metric_args:
  G: 1.0
  M: 1.0
  Q: 0.0
  a: 0.0
  c: 1.0
other_coordinate_systems: []
problem: geodesic_perihilion
recompute_volume_elements: true
store_quantities:
  store_GR_tensors: false
  store_distortion: true
  store_symmetric: true

2025-07-13 12:14:11,040 - INFO - Freezing the config before training...
2025-07-13 12:14:11,042 - INFO - Config freezed successfully.
2025-07-13 12:14:11,043 - INFO - Visible devices: [CudaDevice(id=0)]
2025-07-13 12:14:11,043 - INFO - JAX default backend: gpu
2025-07-13 12:14:11,043 - INFO - Initializing training...
2025-07-13 12:14:11,186 - INFO - Loading data from /system/user/publicwork/crangano/neurips_runs/neurips_data/EinFields/geodesic_perihilion/spherical/no_scale
2025-07-13 12:14:11,186 - INFO - Loading metric:
2025-07-13 12:14:13,261 - INFO - Metric: (2097152, 16)
2025-07-13 12:14:13,564 - INFO - Loading Jacobian data for training.
2025-07-13 12:14:14,969 - INFO - Jacobian: (2097152, 64)
2025-07-13 12:14:14,970 - INFO - Loading Jacobian and Hessian for validation.
2025-07-13 12:14:23,384 - INFO - Loading complete.
2025-07-13 12:14:24,810 - INFO - Initializing a new run
2025-07-13 12:14:29,682 - INFO - Model: MLP with 6 x 128 hidden layers and 16 outputs
2025-07-13 12:14:29,682 - INFO - Number of parameters: 101776
2025-07-13 12:14:29,682 - INFO - Starting training with 100 batch(es)
2025-07-13 12:24:41,427 - INFO - Loss final: 4.9997393378187205e-12, ... {'metric': Array(4.9987883e-12, dtype=float32), 'jacobian': Array(9.504637e-16, dtype=float32)}
2025-07-13 12:24:41,432 - INFO - Storing checkpoint at /system/user/publicwork/crangano/neurips_runs/checkpoints/EinFields/schwarzschild/geodesic_perihilion/0iblhdd5/checkpoint
2025-07-13 12:24:42,196 - INFO - Training finished in 631.1526534557343 s
